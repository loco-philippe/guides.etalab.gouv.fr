<!DOCTYPE html>
<html lang="fr-FR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API découpage administratif | guides.etalab.gouv.fr</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/images/favicon.png">
    <meta name="description" content="Les guides d'Etalab : vous accompagner dans la réalisation de vos projets relatifs aux données, algorithmes et codes sources.">
    <link rel="preload" href="/assets/css/0.styles.067cb4b5.css" as="style"><link rel="preload" href="/assets/js/app.b4ea98d0.js" as="script"><link rel="preload" href="/assets/js/2.c7a6e61f.js" as="script"><link rel="preload" href="/assets/js/34.d4b4a56f.js" as="script"><link rel="prefetch" href="/assets/js/10.2930becd.js"><link rel="prefetch" href="/assets/js/11.090866cc.js"><link rel="prefetch" href="/assets/js/12.24fa0a80.js"><link rel="prefetch" href="/assets/js/13.116d8c1e.js"><link rel="prefetch" href="/assets/js/14.11bbc3c9.js"><link rel="prefetch" href="/assets/js/15.b86b4acc.js"><link rel="prefetch" href="/assets/js/16.c8977046.js"><link rel="prefetch" href="/assets/js/17.e6c8f3c8.js"><link rel="prefetch" href="/assets/js/18.a593c94a.js"><link rel="prefetch" href="/assets/js/19.fd337a64.js"><link rel="prefetch" href="/assets/js/20.c3c71a7d.js"><link rel="prefetch" href="/assets/js/21.adae2c70.js"><link rel="prefetch" href="/assets/js/22.b4be4a5e.js"><link rel="prefetch" href="/assets/js/23.01cf3b8a.js"><link rel="prefetch" href="/assets/js/24.9b26d610.js"><link rel="prefetch" href="/assets/js/25.90e65e37.js"><link rel="prefetch" href="/assets/js/26.65f6403d.js"><link rel="prefetch" href="/assets/js/27.852ecbb0.js"><link rel="prefetch" href="/assets/js/28.21070389.js"><link rel="prefetch" href="/assets/js/29.e07977a1.js"><link rel="prefetch" href="/assets/js/3.d21d7d4e.js"><link rel="prefetch" href="/assets/js/30.d54b592a.js"><link rel="prefetch" href="/assets/js/31.16e5dfce.js"><link rel="prefetch" href="/assets/js/32.acb25757.js"><link rel="prefetch" href="/assets/js/33.33f63db5.js"><link rel="prefetch" href="/assets/js/35.bda21abd.js"><link rel="prefetch" href="/assets/js/36.590ca06c.js"><link rel="prefetch" href="/assets/js/37.b5104cad.js"><link rel="prefetch" href="/assets/js/38.fefee1e8.js"><link rel="prefetch" href="/assets/js/39.d123d903.js"><link rel="prefetch" href="/assets/js/4.a9ccacf8.js"><link rel="prefetch" href="/assets/js/40.a6ce03d4.js"><link rel="prefetch" href="/assets/js/41.46aa0cc4.js"><link rel="prefetch" href="/assets/js/42.9b7f14b8.js"><link rel="prefetch" href="/assets/js/43.f7aba4e1.js"><link rel="prefetch" href="/assets/js/44.7525ff1e.js"><link rel="prefetch" href="/assets/js/45.67c740b7.js"><link rel="prefetch" href="/assets/js/46.c0f35329.js"><link rel="prefetch" href="/assets/js/47.bc91a0be.js"><link rel="prefetch" href="/assets/js/48.6dff9c98.js"><link rel="prefetch" href="/assets/js/49.a5eede6b.js"><link rel="prefetch" href="/assets/js/5.286d5792.js"><link rel="prefetch" href="/assets/js/50.e3df4620.js"><link rel="prefetch" href="/assets/js/51.92b81ccc.js"><link rel="prefetch" href="/assets/js/52.bed6cf3b.js"><link rel="prefetch" href="/assets/js/53.50ca603b.js"><link rel="prefetch" href="/assets/js/54.8da38b19.js"><link rel="prefetch" href="/assets/js/55.b8a020fa.js"><link rel="prefetch" href="/assets/js/56.bcb5a6d9.js"><link rel="prefetch" href="/assets/js/57.ee919747.js"><link rel="prefetch" href="/assets/js/58.4b98a163.js"><link rel="prefetch" href="/assets/js/59.97a1930a.js"><link rel="prefetch" href="/assets/js/6.5c76a76c.js"><link rel="prefetch" href="/assets/js/60.59133d01.js"><link rel="prefetch" href="/assets/js/61.2716f6fc.js"><link rel="prefetch" href="/assets/js/62.391e671f.js"><link rel="prefetch" href="/assets/js/7.f10b5619.js"><link rel="prefetch" href="/assets/js/8.9148c140.js"><link rel="prefetch" href="/assets/js/9.365cce33.js">
    <link rel="stylesheet" href="/assets/css/0.styles.067cb4b5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/logo-marianne.svg" alt="guides.etalab.gouv.fr" class="logo"> <span class="site-name can-hide">guides.etalab.gouv.fr</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/accueil.html" class="nav-link">
  📚 Sommaire
</a></div><div class="nav-item"><a href="/pdf.html" class="nav-link">
  💾 Télécharger les guides
</a></div><div class="nav-item"><a href="https://www.etalab.gouv.fr/contact" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ✉️ Contacter Etalab
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://support.data.gouv.fr/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ✉️ Contacter data.gouv.fr
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/etalab/guides.etalab.gouv.fr" target="_blank" rel="noopener noreferrer" class="repo-link">
    Code source
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/accueil.html" class="nav-link">
  📚 Sommaire
</a></div><div class="nav-item"><a href="/pdf.html" class="nav-link">
  💾 Télécharger les guides
</a></div><div class="nav-item"><a href="https://www.etalab.gouv.fr/contact" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ✉️ Contacter Etalab
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://support.data.gouv.fr/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ✉️ Contacter data.gouv.fr
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/etalab/guides.etalab.gouv.fr" target="_blank" rel="noopener noreferrer" class="repo-link">
    Code source
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/apis-geo/" class="sidebar-link">Introduction</a></li><li><a href="/apis-geo/1-api-adresse.html" class="sidebar-link">API Adresse</a></li><li><a href="/apis-geo/2-api-decoupage-administratif.html" class="active sidebar-link">API découpage administratif</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/apis-geo/2-api-decoupage-administratif.html#pourquoi-utiliser-l-api-decoupage-administratif" class="sidebar-link">Pourquoi utiliser l’API découpage administratif ?</a></li><li class="sidebar-sub-header"><a href="/apis-geo/2-api-decoupage-administratif.html#utilisation-de-l-api-dans-un-site-web" class="sidebar-link">Utilisation de l'API dans un site web</a></li><li class="sidebar-sub-header"><a href="/apis-geo/2-api-decoupage-administratif.html#rappels-des-exemples-officiels" class="sidebar-link">Rappels des exemples officiels</a></li><li class="sidebar-sub-header"><a href="/apis-geo/2-api-decoupage-administratif.html#les-sources-alternatives-pour-les-communes" class="sidebar-link">Les sources alternatives pour les communes</a></li><li class="sidebar-sub-header"><a href="/apis-geo/2-api-decoupage-administratif.html#faq" class="sidebar-link">FAQ</a></li></ul></li><li><a href="/apis-geo/3-tuiles-vecteur.html" class="sidebar-link">Tuiles vectorielles</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="api-decoupage-administratif"><a href="#api-decoupage-administratif" class="header-anchor">#</a> API découpage administratif</h1> <h2 id="pourquoi-utiliser-l-api-decoupage-administratif"><a href="#pourquoi-utiliser-l-api-decoupage-administratif" class="header-anchor">#</a> Pourquoi utiliser l’API découpage administratif ?</h2> <p>L’API découpage administratif permet d’obtenir des données administratives française comme :</p> <ul><li>à des échelles différentes (communes, départements, régions),</li> <li>des années différentes (notion de millésime)</li></ul> <p>L'API Découpage Administratif est principalement destinée à un besoin de recherches pour des formulaires en partant du nom de la commune, du code postal ou bien du code INSEE.</p> <p>Les usages départements ou régions bien que pratiquent semblent moins intéressant car les données ne changent quasiment jamais dans le temps et le nombre limités d'éléments fait qu'il est possible de gérer ces informations côté client.</p> <h2 id="utilisation-de-l-api-dans-un-site-web"><a href="#utilisation-de-l-api-dans-un-site-web" class="header-anchor">#</a> Utilisation de l'API dans un site web</h2> <p>L’API est très utile pour permettre de faire <strong>l'auto-complétion</strong> qu’il s’agisse d’un formulaire ou pour permettre de zoomer sur une commune trouvée dans un contexte web</p> <ul><li><a href="http://bl.ocks.org/ThomasG77/0b99013795f76699c5c9a0d7daf4411e" target="_blank" rel="noopener noreferrer">http://bl.ocks.org/ThomasG77/0b99013795f76699c5c9a0d7daf4411e<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>La partie importante se base sur un simple <a href="https://developer.mozilla.org/fr/docs/Web/API/Fetch_API" target="_blank" rel="noopener noreferrer">Fetch<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Il est aussi possible de <a href="https://medium.com/@ThomasG77/api-et-g%C3%A9ocodage-dans-libre-office-calc-488ab78dc360" target="_blank" rel="noopener noreferrer">remplir les informations de coordonnées dans un tableur comme Libre Office<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="rappels-des-exemples-officiels"><a href="#rappels-des-exemples-officiels" class="header-anchor">#</a> Rappels des exemples officiels</h2> <p>Nous présentons ici les exemples les plus courants. Pour des usages plus spécifiques, vous pouvez utiliser <a href="https://geo.api.gouv.fr/decoupage-administratif" target="_blank" rel="noopener noreferrer">les exemples de la documentation officielle<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="utilisation-de-l-api-pour-recuperer-des-communes"><a href="#utilisation-de-l-api-pour-recuperer-des-communes" class="header-anchor">#</a> Utilisation de l’API pour récupérer des communes</h3> <ul><li>Recherche par code postal <a href="https://geo.api.gouv.fr/communes?codePostal=78000" target="_blank" rel="noopener noreferrer">https://geo.api.gouv.fr/communes?codePostal=78000<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Recherche par code INSEE <a href="https://geo.api.gouv.fr/communes?code=44109" target="_blank" rel="noopener noreferrer">https://geo.api.gouv.fr/communes?code=44109<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Recherche par nom <a href="https://geo.api.gouv.fr/communes?nom=Nantes&amp;boost=population&amp;limit=5" target="_blank" rel="noopener noreferrer">https://geo.api.gouv.fr/communes?nom=Nantes&amp;boost=population&amp;limit=5<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (on ajoute un boost par population pour que la plus grand commune soit privilégiée)</li> <li>Par coordonnées <a href="https://geo.api.gouv.fr/communes?lat=47.0482944&amp;lon=-1.1501568" target="_blank" rel="noopener noreferrer">https://geo.api.gouv.fr/communes?lat=47.0482944&amp;lon=-1.1501568<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Filtrer par département pour éviter les problèmes liés à l'homonymie de commune, par exemple la commune de Saint-Aubin existe dans les départements 10, 21, 36, 39, 40, 47, 59, 62, 91 et 02 <a href="https://geo.api.gouv.fr/communes?nom=Saint-Aubin&amp;codeDepartement=21" target="_blank" rel="noopener noreferrer">https://geo.api.gouv.fr/communes?nom=Saint-Aubin&amp;codeDepartement=21<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Obtenir toutes les communes d'un département <a href="https://geo.api.gouv.fr/departements/44/communes" target="_blank" rel="noopener noreferrer">https://geo.api.gouv.fr/departements/44/communes<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Obtenir toutes les communes d'une région <a href="https://geo.api.gouv.fr/communes?codeRegion=84" target="_blank" rel="noopener noreferrer">https://geo.api.gouv.fr/communes?codeRegion=84<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>Tous les exemples ci-dessus ne filtrent pas les champs, ne permettent pas de choisir si on veut des géométries pour les communes: soit le centre, au sens mathématique, de la commune, soit son contour, ni ne permettent pas le choix de la sérialisation: pour la cartographie, généralement, on utilise un JSON spécifique dit GeoJSON pour cela.</p> <p>La meilleure manière de comprendre comment cela fonctionne est d'utiliser <a href="https://geo.api.gouv.fr/decoupage-administratif/communes#advanced" target="_blank" rel="noopener noreferrer">la démo recherche avancée de la documentation officielle<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Elle permet en cochant de voir comment l'URL d'appel change en particulier l'option <code>fields</code> pour ne retourner que les colonnes/champs nécessaires.</p> <p><strong>Ce qu'il faut retenir pour les aspects géo,</strong></p> <ul><li>si vous souhaitez les GeoJSON avec le centre de la commune, rajoutez aux urls de la première partie <code>&amp;format=geojson&amp;geometry=centre</code> si votre URL contient déjà un <code>?</code> sinon il faut ajouter plutôt <code>?format=geojson&amp;geometry=centre</code></li> <li>si vous souhaitez les GeoJSON avec le contour de la commune, rajoutez aux urls de la première partie <code>&amp;format=geojson&amp;geometry=contour</code> si votre URL contient déjà un <code>?</code> sinon il faut ajouter plutôt <code>?format=geojson&amp;geometry=contour</code></li></ul> <p>Un exemple pour illustrer</p> <p><a href="https://geo.api.gouv.fr/communes?lat=47.0482944&amp;lon=-1.1501568" target="_blank" rel="noopener noreferrer">https://geo.api.gouv.fr/communes?lat=47.0482944&amp;lon=-1.1501568<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>devient :</p> <ul><li>Si l’on souhaite le centre de la commune : <a href="https://geo.api.gouv.fr/communes?lat=47.0482944&amp;lon=-1.1501568&amp;format=geojson&amp;geometry=centre" target="_blank" rel="noopener noreferrer">https://geo.api.gouv.fr/communes?lat=47.0482944&amp;lon=-1.1501568&amp;format=geojson&amp;geometry=centre<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Si l’on souhaite le contour de la commune :  <a href="https://geo.api.gouv.fr/communes?lat=47.0482944&amp;lon=-1.1501568&amp;format=geojson&amp;geometry=contour" target="_blank" rel="noopener noreferrer">https://geo.api.gouv.fr/communes?lat=47.0482944&amp;lon=-1.1501568&amp;format=geojson&amp;geometry=contour<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>Il faut également penser à mettre en cache quand on a des appels lourds qui ne changent pas ou qu'on retourne des contours. Ainsi :</p> <ul><li>Sans contour, la réponse fait 480Ko <a href="https://geo.api.gouv.fr/communes?codeRegion=84" target="_blank" rel="noopener noreferrer">https://geo.api.gouv.fr/communes?codeRegion=84<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Avec contour, la réponse fait 34Mo <a href="https://geo.api.gouv.fr/communes?codeRegion=84&amp;format=geojson&amp;geometry=contour" target="_blank" rel="noopener noreferrer">https://geo.api.gouv.fr/communes?codeRegion=84&amp;format=geojson&amp;geometry=contour<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>Vous pouvez très bien sauvegarder dans un fichier le résultat des URLs ci-dessus car le résultat ne va pas changer en permanence car ce n'est pas de l'autocomplétion.</p> <h3 id="utilisation-de-l-api-pour-recuperer-des-regions-et-des-departements"><a href="#utilisation-de-l-api-pour-recuperer-des-regions-et-des-departements" class="header-anchor">#</a> Utilisation de l’API pour récupérer des régions et des départements</h3> <p>Dans ce cas de figure, le principal intérêt est la correspondance entre un nom et un code.</p> <p>Si l’on souhaite le code d'un département ou d'une région, on prend :</p> <ul><li>pour la région <a href="https://geo.api.gouv.fr/regions?nom=Auvergne" target="_blank" rel="noopener noreferrer">https://geo.api.gouv.fr/regions?nom=Auvergne<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>pour le département <a href="https://geo.api.gouv.fr/departements?nom=Loire%20Atl" target="_blank" rel="noopener noreferrer">https://geo.api.gouv.fr/departements?nom=Loire Atl<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>Les cas départements et régions fonctionnent comme les communes et changent très rarement. Il est souvent envisageable d'avoir les fichiers globaux JSON plutôt que passer par des appels API. On a ainsi sous forme JSON (sans géométrie):</p> <ul><li><a href="https://unpkg.com/@etalab/decoupage-administratif/data/departements.json" target="_blank" rel="noopener noreferrer">Les départements<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://unpkg.com/@etalab/decoupage-administratif/data/regions.json" target="_blank" rel="noopener noreferrer">Les régions<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="les-sources-alternatives-pour-les-communes"><a href="#les-sources-alternatives-pour-les-communes" class="header-anchor">#</a> Les sources alternatives pour les communes</h2> <h3 id="utiliser-le-wfs-de-l-ign"><a href="#utiliser-le-wfs-de-l-ign" class="header-anchor">#</a> Utiliser le WFS de l'IGN</h3> <p>Un <a href="https://fr.wikipedia.org/wiki/Web_Feature_Service" target="_blank" rel="noopener noreferrer">WFS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (Web Feature Service) est un service web d’inspiration <a href="https://fr.wikipedia.org/wiki/SOAP" target="_blank" rel="noopener noreferrer">SOAP<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Il est basé sur une approche en <a href="https://fr.wikipedia.org/wiki/Extensible_Markup_Language" target="_blank" rel="noopener noreferrer">XML<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Le WFS de l’IGN existe en version 1.0.0, 1.1.0 et 2.0.0.
Cette dernière rajoute des facilités en particulier pour paginer les appels. Généralement, sauf si le serveur est très ancien, c'est la version 2.0.0 qu'il faut privilégier.</p> <p>Même s'il est possible de retrouver comment fonctionne le WFS en regardant le <a href="https://www.ogc.org/standards/wfs" target="_blank" rel="noopener noreferrer">standard WFS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, nous vous recommandons plutôt d'aller sur <a href="https://georezo.net/wiki/main/standards/wfs" target="_blank" rel="noopener noreferrer">la page WFS du site GeoRezo.net<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Ce n'est pas un prérequis ici mais pourra vous aider à approfondir le sujet si vous devez utiliser ce standard plus régulièrement.</p> <p>Si vous avez besoin de récupérer toutes les communes, il est plutôt recommandé de récupérer les données brutes depuis <a href="https://geoservices.ign.fr/adminexpress" target="_blank" rel="noopener noreferrer">Admin Express<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, documenté aussi sur cette page. Nous vous recommandons d'avoir installé <a href="https://gdal.org/" target="_blank" rel="noopener noreferrer">GDAL<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, un utilitaire en ligne de commande.</p> <p>Son principal intérêt est de pallier à certains scénarios que n'adresse pas pour le moment l'API Découpage Administratif. Il nécessite de comprendre quelques préalables.</p> <h4 id="lister-les-couches-d-un-endpoint-wfs"><a href="#lister-les-couches-d-un-endpoint-wfs" class="header-anchor">#</a> Lister les couches d'un endpoint WFS</h4> <p>On doit pouvoir lister les couches du service fournissant les communes</p> <p><em>Dans le navigateur, peu lisible car XML avec un &quot;GetCapabilities&quot;</em></p> <p><a href="https://wxs.ign.fr/administratif/geoportail/wfs/?SERVICE=WFS&amp;REQUEST=GetCapabilities&amp;VERSION=2.0.0" target="_blank" rel="noopener noreferrer">https://wxs.ign.fr/administratif/geoportail/wfs/?SERVICE=WFS&amp;REQUEST=GetCapabilities&amp;VERSION=2.0.0<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><em>Avec GDAL</em></p> <div class="language- extra-class"><pre class="language-text"><code>ogrinfo -so WFS:https://wxs.ign.fr/administratif/geoportail/wfs
</code></pre></div><p>Astuce: recommencez avec l'option <code>--DEBUG ON</code> comme ci-dessous</p> <div class="language- extra-class"><pre class="language-text"><code>ogrinfo --DEBUG ON -so WFS:https://wxs.ign.fr/administratif/geoportail/wfs
</code></pre></div><p>L'intérêt de la manoeuvre est de pouvoir comprendre les appels HTTP utilisés lors de l'usage du WFS plutôt que devoir apprendre la spécification WFS.</p> <h4 id="trouver-la-structure-du-wfs"><a href="#trouver-la-structure-du-wfs" class="header-anchor">#</a> Trouver la structure du WFS</h4> <p>Trouver la structure du WFS est important car pour pouvoir filtrer, vous pouvez soit utiliser des filtres qui jouent sur les attributs soit sur des propriétés spatiales. Il s’agit donc de connaître le nom des champs. Il s’agit également potentiellement de connaitre le nom de la colonne contenant la géométrie pour pouvoir effectuer les requêtes spatiales.</p> <p>On part dans cet exemple de la couche <code>ADMINEXPRESS-COG.LATEST:commune</code></p> <p>Dans le navigateur, copiez l'URL :</p> <p><a href="https://wxs.ign.fr/administratif/geoportail/wfs/?SERVICE=WFS&amp;REQUEST=DescribeFeatureType&amp;VERSION=2.0.0&amp;TYPENAMES=ADMINEXPRESS-COG.LATEST:commune&amp;outputFormat=application/json" target="_blank" rel="noopener noreferrer">https://wxs.ign.fr/administratif/geoportail/wfs/?SERVICE=WFS&amp;REQUEST=DescribeFeatureType&amp;VERSION=2.0.0&amp;TYPENAMES=ADMINEXPRESS-COG.LATEST:commune&amp;outputFormat=application/json<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Avec GDAL, en ligne de commande</p> <div class="language- extra-class"><pre class="language-text"><code>ogrinfo -so -noextent WFS:https://wxs.ign.fr/administratif/geoportail/wfs &quot;ADMINEXPRESS-COG.LATEST:commune&quot;
</code></pre></div><p>Dans les 2 cas, on sait quelles sont les colonnes disponibles. On pourra réutiliser leur nom pour faire des filtres ou choisir les colonnes qui seront retournées.</p> <h4 id="usages-du-wfs"><a href="#usages-du-wfs" class="header-anchor">#</a> Usages du WFS</h4> <p>Nous avons appris quelles couches contiennent un WFS, quelle est la structure d'une couche comme ses noms de champs. Maintenant on va pouvoir consommer la couche pour la filtrer.</p> <p>Il est possible de le faire via un appel à une URL ou en passant pas des utilitaires associés à GDAL, utiles pour notre besoin:</p> <ul><li>le premier <code>ogrinfo</code> permet d'inspecter le contenu d'une source de données, dans ce cas particulier, un WFS.</li> <li>le second <code>ogr2ogr</code> permet de consommer le WFS en utilisant si nécessaire la pagination et surtout de transformer le GML dans d'autres formats géographiques comme le SHP (Shapefile), le GPKG (Geopackage), le GeoJSON, le CSV parmi les formats géospatiaux les plus courants.</li></ul> <p>Parmi les cas régulièrement demandé, il nous est demandé de répondre à des besoins de multi-filtrage, par exemple si on veut les communes de plusieurs régions ou départements.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Filtrer les communes pour plusieurs départements en retournant un GeoJSON</span>
ogr2ogr -f GeoJSON communes-44-35.geojson <span class="token punctuation">\</span>
        --config OGR_WFS_PAGING_ALLOWED ON <span class="token punctuation">\</span>
        --config OGR_WFS_PAGE_SIZE <span class="token number">250</span> <span class="token punctuation">\</span>
        WFS:https://wxs.ign.fr/administratif/geoportail/wfs <span class="token punctuation">\</span>
        -sql <span class="token string">&quot;SELECT * FROM <span class="token entity" title="\&quot;">\&quot;</span>ADMINEXPRESS-COG.LATEST:commune<span class="token entity" title="\&quot;">\&quot;</span> WHERE insee_dep IN ('44', '35')&quot;</span> <span class="token punctuation">\</span>
        -lco <span class="token assign-left variable">RFC7946</span><span class="token operator">=</span>YES
</code></pre></div><p>Nous vous proposons des recettes ci-dessous. La majorité n'utilise que les communes mais nous employons ponctuellement les EPCI, ayant parfois des demandes pour adresser comment les récupérer ou récupérer leurs communes</p> <p>On peut dans une premier temps récupérer la commune qui a un code INSEE car elle contient aussi le SIRET de l'EPCI.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Obtenir la commune par code commune INSEE sous forme CSV</span>
ogr2ogr -f CSV commune-44109.csv WFS:https://wxs.ign.fr/administratif/geoportail/wfs -sql <span class="token string">&quot;SELECT * FROM <span class="token entity" title="\&quot;">\&quot;</span>ADMINEXPRESS-COG.LATEST:commune<span class="token entity" title="\&quot;">\&quot;</span> WHERE insee_com = '44109'&quot;</span>
</code></pre></div><p>En inspectant le fichier epci-with-44109-from-geom.csv, on voit que le code SIREN est <code>244400404</code>. On peut ainsi retourner les communes qui sont membres de l'EPCI.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Obtenir les communes de l'EPCI grâce au code Siren de l'EPCI</span>
ogr2ogr -f GeoJSON communes-epci-with-44109.geojson WFS:https://wxs.ign.fr/administratif/geoportail/wfs -sql <span class="token string">&quot;SELECT * FROM <span class="token entity" title="\&quot;">\&quot;</span>ADMINEXPRESS-COG.LATEST:commune<span class="token entity" title="\&quot;">\&quot;</span> WHERE siren_epci = '244400404'&quot;</span>
</code></pre></div><p>On pourrait aussi obtenir la commune qui contient le point de longitude -1.54241 et latitude 47.21791 sous forme CSV puis depuis le code SIREN, faire la même opération que ci-dessus.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>ogr2ogr -f CSV commune-44109-from-geom.csv WFS:https://wxs.ign.fr/administratif/geoportail/wfs -sql <span class="token string">&quot;SELECT * FROM <span class="token entity" title="\&quot;">\&quot;</span>ADMINEXPRESS-COG.LATEST:commune<span class="token entity" title="\&quot;">\&quot;</span> WHERE ST_Contains(ST_GeomFromText('POINT(-1.54241 47.21791)', 'EPSG:4326'), the_geom)&quot;</span> -lco <span class="token assign-left variable">RFC7946</span><span class="token operator">=</span>YES
</code></pre></div><p>Il est possible aussi d'obtenir l'EPCI lui-même:</p> <p>depuis un code SIREN :</p> <div class="language-bash extra-class"><pre class="language-bash"><code>ogr2ogr -f GeoJSON epci-with-44109-from-siren.geojson WFS:https://wxs.ign.fr/administratif/geoportail/wfs -sql <span class="token string">&quot;SELECT * FROM <span class="token entity" title="\&quot;">\&quot;</span>ADMINEXPRESS-COG.LATEST:epci<span class="token entity" title="\&quot;">\&quot;</span> WHERE code_siren = '244400404'&quot;</span>
</code></pre></div><p>depuis un point qui est est contenu dans l'EPCI :</p> <div class="language-bash extra-class"><pre class="language-bash"><code>ogr2ogr -f GeoJSON epci-with-44109-from-geom.geojson WFS:https://wxs.ign.fr/administratif/geoportail/wfs -sql <span class="token string">&quot;SELECT * FROM <span class="token entity" title="\&quot;">\&quot;</span>ADMINEXPRESS-COG.LATEST:epci<span class="token entity" title="\&quot;">\&quot;</span> WHERE ST_Contains(ST_GeomFromText('POINT(-1.54241 47.21791)', 'EPSG:4326'), the_geom)&quot;</span>
</code></pre></div><p><strong>Faq WFS</strong></p> <ul><li>Pourquoi ne pas passer par le WFS pour de l'autocomplétion? Parce que cela demeure nettement plus lent qu'une API dédiée car il n'y a pas d'index spécifiques pour cet usage.</li></ul> <h3 id="passer-par-les-fichiers-admin-express"><a href="#passer-par-les-fichiers-admin-express" class="header-anchor">#</a> Passer par les fichiers Admin Express</h3> <p>Quand on a besoin de travailler avec les données France entière et qu'on a un back-end, c'est la solution à privilégier.</p> <h4 id="contexte"><a href="#contexte" class="header-anchor">#</a> Contexte</h4> <p>Historiquement, il existait un produit nommé Geofla pour avoir les communes qui a été depuis remplacé par un nouveau jeu de données dit Admin Express qui contient les données suivantes :</p> <ul><li>DEPARTEMENT (Polygon)</li> <li>COMMUNE_ASSOCIEE_OU_DELEGUEE (Polygon)</li> <li>COMMUNE (Polygon)</li> <li>COLLECTIVITE_TERRITORIALE (Polygon)</li> <li>ARRONDISSEMENT_MUNICIPAL (Polygon)</li> <li>EPCI (Polygon)</li> <li>REGION (Polygon)</li> <li>CANTON (Polygon)</li> <li>CHFLIEU_COMMUNE_ASSOCIEE_OU_DELEGUEE (Point)</li> <li>CHFLIEU_COMMUNE (Point)</li> <li>CHFLIEU_ARRONDISSEMENT_MUNICIPAL (Point)</li> <li>ARRONDISSEMENT (Polygon)</li></ul> <p>Le jeu de données et la documentation officielle sont disponible <a href="https://geoservices.ign.fr/adminexpress" target="_blank" rel="noopener noreferrer">la page officielle Admin Express<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h4 id="differents-produits-admin-express"><a href="#differents-produits-admin-express" class="header-anchor">#</a> Différents produits Admin Express</h4> <p>Il existe des <strong>différences entre les produits Admin Express</strong>, nous vous invitons à consulter cet <a href="https://geoservices.ign.fr/admin-express-passe-la-grande-echelle" target="_blank" rel="noopener noreferrer">article résumant ces différences<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Ce qu'il faut retenir pour choisir les produits:</p> <ul><li>Si vous avez besoin de suivre l'évolution des communes par mois, prendre &quot;Admin Express&quot; simple.</li> <li>Si vous voulez faire des cartes thématiques qui utilisent les données INSEE, prenez les données &quot;Admin Express COG Carto&quot; qui sont généralisées c'est à dire avec moins de points pour les contours.</li> <li>Si vous avez besoin de compter par exemple les commerces qui sont dans une commune mais aussi de faire des cartes thématiques, prenez plutôt &quot;Admin Express COG&quot; car les coordonnées sont plus précises.</li></ul> <h4 id="le-piege-des-projections"><a href="#le-piege-des-projections" class="header-anchor">#</a> Le &quot;piège&quot; des projections</h4> <p>L'autre piège lors de la récupération de ces données est de prendre les données dans les &quot;bonnes projections&quot;: il existe des jeux de données dont la description mentionne &quot;par territoire&quot; et &quot;France entière&quot;. Pour comprendre, en empruntant des raccourcis, il faut savoir que la France utilise ce qu'on appelle des systèmes de projection officiels qui définissent comment &quot;bien placer les coordonnées mesurées&quot;. Ces systèmes sont choisis pour pouvoir garder une grande précision de mesure qui permettent ensuite d'être sûr de l'emplacement de votre maison au centimètre près. L'inconvénient est qu'ils fonctionnent sur des étendues faibles: ils sont différents sur la métropole et sur les DOM. Si vous prenez les données &quot;par territoire&quot;, vous récupérerez les données pour chaque territoire séparément avec chacun sa projection officielle. Si vous prenez France entière, vous aurez les données assemblées dans une projection mondiale indépendamment des territoires.</p> <p>Conclusion à tirer sur les projections des données:</p> <ul><li>si vous devez travailler sur France métropolitaine et DOM, vous pouvez prendre les données &quot;France entière&quot;</li> <li>Si vous travaillez uniquement sur un DOM ou uniquement la métropole, vous pourrez travailler tant avec les données &quot;par territoire&quot; que &quot;France entière&quot;</li></ul> <h2 id="faq"><a href="#faq" class="header-anchor">#</a> FAQ</h2> <h3 id="bon-a-savoir-concernant-les-communes"><a href="#bon-a-savoir-concernant-les-communes" class="header-anchor">#</a> Bon à savoir concernant les communes</h3> <ul><li><a href="https://twitter.com/JulesGrandin/status/1448563444601532422" target="_blank" rel="noopener noreferrer">La longueur des noms de commune peut être problématique<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li> <li><a href="https://www.collectivites-locales.gouv.fr/sites/default/files/Accueil/Notes" target="_blank" rel="noopener noreferrer">Il existe une normalisation des noms de communes<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li> <li>Il existe des communes homonymes, le nom n'est donc pas un identifiant fiable.</li> <li>Le code postal ne correspond pas à toujours à une seule commune.</li> <li>Certaines communes ont plusieurs codes postaux.</li> <li>Le code postal peut contenir le code d'un autre département que son département réel.</li></ul> <h3 id="bonnes-pratiques-a-adopter"><a href="#bonnes-pratiques-a-adopter" class="header-anchor">#</a> Bonnes pratiques à adopter</h3> <p>Partout où vous le pouvez, utilisez le code INSEE du COG (Code Offficiel Géographique) plutôt qu'un code postal ou un nom. Celui-ci est le plus fiable dans le temps même si des cas particuliers emergent parfois suite aux évolutions des communes (fusions ou séparation).</p> <p>Avec l'API Découpage Administratif, cette complexité du COG est cachée. Si vous avez des besoins avancés, vous pouvez utiliser soit <a href="https://www.insee.fr/fr/information/2560452" target="_blank" rel="noopener noreferrer">les fichiers du COG<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> soit pour une recherche ponctuel, passer par <a href="https://www.insee.fr/fr/recherche/recherche-geographique?debut=0" target="_blank" rel="noopener noreferrer">l'interface de recherche de commune<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/etalab/guides.etalab.gouv.fr/edit/master/apis-geo/2-api-decoupage-administratif.md" target="_blank" rel="noopener noreferrer">Proposer des modifications sur cette page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/apis-geo/1-api-adresse.html" class="prev">
        API Adresse
      </a></span> <span class="next"><a href="/apis-geo/3-tuiles-vecteur.html">
        Tuiles vectorielles
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b4ea98d0.js" defer></script><script src="/assets/js/2.c7a6e61f.js" defer></script><script src="/assets/js/34.d4b4a56f.js" defer></script>
  </body>
</html>
